#############################################################################
#                                                                           #
# appveyor.yml                                                              #
#                                                                           #
# Author: Denes Solti                                                       #
#                                                                           #
#############################################################################

# common configuration for ALL branches
image: Visual Studio 2019

environment:
  COVERALLS_REPO_TOKEN:  
    secure: p2Kcud3WthUkXXcArmyAEggtW8E3L7ELxH0TXnjlnhmCUMPAQ9s5ApIX3By05W8B
  GITHUB_REPO_TOKEN:
    secure: qJEufJv866eebR/Boe1UnV3p1arOIX9BTyqAQnAVY49h4Ks40Sr0rHb3iN70e7BZ
  NUGET_REPO_TOKEN:
    secure: UlwkykISUtzAOpzVe0HdezbxNzE5UAXBpnMGu7rApIgjWbDG3ueXuFC92IOIpmtk
  GITHUB_EMAIL:
    secure: Z6F+xZzdZzc5DMYB/4J0KUhyoTzTlXH75ciGl7hFH9s=

branches:
  # blacklist
  except:
    - gh-pages

# prevent MSBuild from running
build: off

before_test:
  - ps: >-

      Set-Location -path "scripts"

      .(".\includes.ps1")

test_script:
  - ps: Run-Script ".\test.appveyor.ps1"

after_test:
  - ps: Run-Script ".\uploadtestresults.appveyor.ps1"

# override settings for `master` branch
for:
-
  branches:
    only:
      - master

  before_deploy:
    - cmd: gitconfig.appveyor
 
  deploy_script:
    # update documentation
    - ps: Run-Script ".\gh-pages.ps1"
    # publish nuget package
    - cmd: deploy.appveyor